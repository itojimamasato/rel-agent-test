# AGENT-One è¦ä»¶å®šç¾©æ›¸

**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.3  
**ä½œæˆæ—¥**: 2025å¹´1æœˆ  
**æ›´æ–°æ—¥**: 2025å¹´1æœˆ  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: MVPé–‹ç™ºä¸­

---

## 1. æ¦‚è¦

### 1.1 ã‚³ãƒ³ã‚»ãƒ—ãƒˆ

AGENT-Oneã¯ã€**ã‚¢ãƒ—ãƒªä¿å®ˆã«ç‰¹åŒ–ã—ãŸAIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**ã§ã‚ã‚‹ã€‚åˆ©ç”¨è€…ã¯å–¶æ¥­æ‹…å½“ã‚„ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã§ã€æ—¢å­˜ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã¤ã„ã¦ã®æ§˜ã€…ãªèª¿æŸ»ã‚’AIã«ä¾é ¼ã§ãã‚‹ã€‚

### 1.2 è§£æ±ºã™ã‚‹èª²é¡Œ

| èª²é¡Œ | AGENT-Oneã«ã‚ˆã‚‹è§£æ±º |
|------|---------------------|
| ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ç†è§£ã«æ™‚é–“ãŒã‹ã‹ã‚‹ | AIãŒã‚³ãƒ¼ãƒ‰ã‚’è§£æã—ã€æ©Ÿèƒ½ã®ä½¿ã„æ–¹ã‚’èª¬æ˜ |
| å·¥æ•°è¦‹ç©ã‚Šã®å±äººåŒ– | AIãŒä½œæ¥­åˆ†è§£ã¨å·¥æ•°ç®—å‡ºã‚’æ”¯æ´ |
| ãƒã‚°èª¿æŸ»ã®åŠ¹ç‡åŒ– | GitHub/Backlog Issueã¨ã‚³ãƒ¼ãƒ‰ã‚’AIãŒæ¨ªæ–­çš„ã«èª¿æŸ» |

### 1.3 å¯¾è±¡ãƒ¦ãƒ¼ã‚¶ãƒ¼

- å–¶æ¥­æ‹…å½“ï¼šé¡§å®¢ã¸ã®è¦‹ç©ã‚Šæç¤ºæ™‚ã«åˆ©ç”¨
- ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ï¼šä¿å®ˆä½œæ¥­ã®èª¿æŸ»ãƒ»è¦‹ç©ã‚Šã«åˆ©ç”¨

---

## 2. ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹

### 2.1 æ—¢å­˜ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åˆ©ç”¨æ–¹æ³•èª¿æŸ»

**æ¦‚è¦**: ãƒãƒ£ãƒƒãƒˆç”»é¢ã§æ©Ÿèƒ½ã®åˆ©ç”¨æ–¹æ³•ã‚’è³ªå•ã™ã‚‹ã¨ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’è§£æã—ã¦ä½¿ã„æ–¹ã‚’èª¬æ˜ã™ã‚‹ã€‚

**ãƒ•ãƒ­ãƒ¼**:
```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ­ã‚°ã‚¤ãƒ³ï¼ˆClerkèªè¨¼ï¼‰
2. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é¸æŠ
3. ã€Œã“ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã€‡ã€‡æ©Ÿèƒ½ã®åˆ©ç”¨æ–¹æ³•ã‚’æ•™ãˆã¦ã€ã¨å…¥åŠ›
4. AIãŒGitHub/BacklogçµŒç”±ã§ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—
5. AIãŒã‚³ãƒ¼ãƒ‰ã‚’è§£æã—ã€åˆ©ç”¨æ–¹æ³•ã‚’å›ç­”
```

**å…¥åŠ›ä¾‹**:
> ã“ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ¤œç´¢æ©Ÿèƒ½ã®åˆ©ç”¨æ–¹æ³•ã‚’æ•™ãˆã¦

**å‡ºåŠ›ä¾‹**:
> æ¤œç´¢æ©Ÿèƒ½ã¯ä»¥ä¸‹ã®æ‰‹é †ã§åˆ©ç”¨ã§ãã¾ã™ï¼š
> 1. ãƒ˜ãƒƒãƒ€ãƒ¼ã®æ¤œç´¢ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
> 2. ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦Enter
> 3. çµæœä¸€è¦§ã‹ã‚‰è©²å½“é …ç›®ã‚’é¸æŠ
> 
> æŠ€è¡“çš„ã«ã¯ `SearchController.java` ã® `search()` ãƒ¡ã‚½ãƒƒãƒ‰ãŒ...

---

### 2.2 æ©Ÿèƒ½è¿½åŠ ã®å·¥æ•°è¦‹ç©ã‚Š

**æ¦‚è¦**: æ©Ÿèƒ½è¿½åŠ ã®ä¾é ¼ã«å¯¾ã—ã€å¿…è¦ãªä½œæ¥­å†…å®¹ã¨å·¥æ•°ã‚’è¦‹ç©ã‚‚ã‚‹ã€‚

**ãƒ•ãƒ­ãƒ¼**:
```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ­ã‚°ã‚¤ãƒ³ï¼ˆClerkèªè¨¼ï¼‰
2. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é¸æŠ
3. ã€Œã€‡ã€‡æ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹å ´åˆã®å·¥æ•°ã‚’è¦‹ç©ã‚‚ã£ã¦ã€ã¨å…¥åŠ›
4. AIãŒã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’è§£æ
5. AIãŒä½œæ¥­å†…å®¹ä¸€è¦§ã¨å„å·¥æ•°ã‚’å›ç­”
```

**å…¥åŠ›ä¾‹**:
> ã“ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«CSVã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹å ´åˆã€å¿…è¦ãªå¯¾å¿œã¨ã©ã‚Œãã‚‰ã„ã®å·¥æ•°ãŒã‹ã‹ã‚‹ã®ã‹è¦‹ç©ã‚‚ã£ã¦

**å‡ºåŠ›ä¾‹**:
> ## ä½œæ¥­å†…å®¹ã¨å·¥æ•°è¦‹ç©ã‚Š
> 
> | ä½œæ¥­é …ç›® | å·¥æ•° | å‚™è€ƒ |
> |---------|------|------|
> | APIè¨­è¨ˆãƒ»å®Ÿè£… | 4h | ExportControlleræ–°è¦ä½œæˆ |
> | CSVç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯ | 3h | Apache Commons CSVåˆ©ç”¨ |
> | UIå®Ÿè£…ï¼ˆãƒœã‚¿ãƒ³è¿½åŠ ï¼‰ | 2h | ä¸€è¦§ç”»é¢ã«è¿½åŠ  |
> | å˜ä½“ãƒ†ã‚¹ãƒˆ | 2h | - |
> | çµåˆãƒ†ã‚¹ãƒˆ | 1h | - |
> | **åˆè¨ˆ** | **12h** | |

---

### 2.3 ãƒã‚°èª¿æŸ»

**æ¦‚è¦**: GitHub Issueã¾ãŸã¯Backlogèª²é¡Œã‚’æŒ‡å®šã—ã€ãƒã‚°ä¿®æ­£ã«å¿…è¦ãªå¯¾å¿œå†…å®¹ã¨å·¥æ•°ã‚’è¦‹ç©ã‚‚ã‚‹ã€‚

**ãƒ•ãƒ­ãƒ¼**:
```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ­ã‚°ã‚¤ãƒ³ï¼ˆClerkèªè¨¼ï¼‰
2. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é¸æŠ
3. ã€ŒIssue #123 ã®ãƒã‚°ä¿®æ­£ã«å¿…è¦ãªå¯¾å¿œã¨å·¥æ•°ã‚’è¦‹ç©ã‚‚ã£ã¦ã€ã¨å…¥åŠ›
   ã¾ãŸã¯ã€Œèª²é¡Œ PROJECT-123 ã®ãƒã‚°ä¿®æ­£ã«å¿…è¦ãªå¯¾å¿œã¨å·¥æ•°ã‚’è¦‹ç©ã‚‚ã£ã¦ã€ã¨å…¥åŠ›
4. AIãŒIssue/èª²é¡Œå†…å®¹ã‚’å–å¾—
5. AIãŒé–¢é€£ã‚³ãƒ¼ãƒ‰ã‚’è§£æ
6. AIãŒä¿®æ­£æ–¹é‡ã¨å·¥æ•°ã‚’å›ç­”
```

**å…¥åŠ›ä¾‹ï¼ˆGitHubï¼‰**:
> Issue #45 ã®ãƒã‚°ä¿®æ­£ã«å¿…è¦ãªå¯¾å¿œå†…å®¹ã¨å·¥æ•°ã‚’è¦‹ç©ã£ã¦

**å…¥åŠ›ä¾‹ï¼ˆBacklogï¼‰**:
> èª²é¡Œ MYAPP-123 ã®ãƒã‚°ä¿®æ­£ã«å¿…è¦ãªå¯¾å¿œå†…å®¹ã¨å·¥æ•°ã‚’è¦‹ç©ã£ã¦

**å‡ºåŠ›ä¾‹**:
> ## Issue #45: ãƒ­ã‚°ã‚¤ãƒ³æ™‚ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹
> 
> ### åŸå› åˆ†æ
> `AuthService.java` ã® `authenticate()` ãƒ¡ã‚½ãƒƒãƒ‰ã§ã€null ãƒã‚§ãƒƒã‚¯ãŒä¸è¶³ã—ã¦ã„ã¾ã™ã€‚
> 
> ### ä¿®æ­£å†…å®¹ã¨å·¥æ•°
> | ä½œæ¥­é …ç›® | å·¥æ•° | å‚™è€ƒ |
> |---------|------|------|
> | åŸå› èª¿æŸ»ï¼ˆå®Œäº†ï¼‰ | - | ä¸Šè¨˜ã®é€šã‚Š |
> | ã‚³ãƒ¼ãƒ‰ä¿®æ­£ | 1h | null ãƒã‚§ãƒƒã‚¯è¿½åŠ  |
> | å˜ä½“ãƒ†ã‚¹ãƒˆè¿½åŠ  | 1h | å¢ƒç•Œå€¤ãƒ†ã‚¹ãƒˆ |
> | **åˆè¨ˆ** | **2h** | |

---

## 3. æ©Ÿèƒ½è¦ä»¶ï¼ˆMVPï¼‰

### 3.1 ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼æ©Ÿèƒ½ï¼ˆClerkï¼‰

| æ©Ÿèƒ½ | èª¬æ˜ |
|------|------|
| ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ— | æ–°è¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ï¼ˆãƒ¡ãƒ¼ãƒ«/ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã€Google OAuthã€GitHub OAuthï¼‰ |
| ã‚µã‚¤ãƒ³ã‚¤ãƒ³ | æ—¢å­˜ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ­ã‚°ã‚¤ãƒ³ |
| ã‚µã‚¤ãƒ³ã‚¢ã‚¦ãƒˆ | ãƒ­ã‚°ã‚¢ã‚¦ãƒˆå‡¦ç† |
| ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç† | ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ã®ç¶­æŒãƒ»ç¢ºèª |
| ãƒ«ãƒ¼ãƒˆä¿è­· | æœªèªè¨¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶é™ |
| Webhooké€£æº | ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆ/æ›´æ–°æ™‚ã«DBã¨åŒæœŸ |

**èªè¨¼ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ï¼ˆMVPï¼‰**:

| ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ | å¯¾å¿œçŠ¶æ³ | å‚™è€ƒ |
|-------------|----------|------|
| ãƒ¡ãƒ¼ãƒ«/ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ | âœ… å¯¾å¿œ | Clerkæ¨™æº–æ©Ÿèƒ½ |
| Google OAuth | âœ… å¯¾å¿œ | Google Cloud Consoleè¨­å®šå¿…è¦ |
| GitHub OAuth | âœ… å¯¾å¿œ | GitHub OAuth Appè¨­å®šå¿…è¦ |

**ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±**:
```typescript
// Clerkã‹ã‚‰å–å¾—ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±
interface ClerkUser {
  id: string;                    // Clerkå†…éƒ¨ID
  emailAddresses: EmailAddress[];// ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ä¸€è¦§
  firstName: string | null;      // å
  lastName: string | null;       // å§“
  imageUrl: string;              // ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒURL
  createdAt: Date;               // ä½œæˆæ—¥æ™‚
  updatedAt: Date;               // æ›´æ–°æ—¥æ™‚
}
```

---

### 3.2 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†æ©Ÿèƒ½

| æ©Ÿèƒ½ | èª¬æ˜ |
|------|------|
| ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ | åå‰ã€èª¬æ˜ã€ãƒªãƒã‚¸ãƒˆãƒªã‚¿ã‚¤ãƒ—ã€ãƒªãƒã‚¸ãƒˆãƒªURLã€èªè¨¼æƒ…å ±ã‚’ç™»éŒ² |
| ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€è¦§ | ãƒ­ã‚°ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä¸€è¦§è¡¨ç¤º |
| ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç·¨é›† | ç™»éŒ²æƒ…å ±ã®å¤‰æ›´ |
| ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå‰Šé™¤ | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¨é–¢é€£ãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤ |
| ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆ‡ã‚Šæ›¿ãˆ | ãƒãƒ£ãƒƒãƒˆå¯¾è±¡ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é¸æŠ |

**ãƒªãƒã‚¸ãƒˆãƒªã‚¿ã‚¤ãƒ—åˆ¥ã®å¿…é ˆé …ç›®**:

| é …ç›® | GitHub | Backlog |
|------|--------|---------|
| repositoryUrl | âœ… å¿…é ˆ | âœ… å¿…é ˆ |
| githubToken | âœ… å¿…é ˆï¼ˆãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªï¼‰ | - |
| backlogDomain | - | âœ… å¿…é ˆ |
| backlogApiKey | - | âœ… å¿…é ˆï¼ˆèª²é¡Œå–å¾—ç”¨ï¼‰ |
| backlogProjectKey | - | âœ… å¿…é ˆ |
| backlogEmail | - | âœ… å¿…é ˆï¼ˆGitèªè¨¼ç”¨ï¼‰ |
| backlogGitPassword | - | âœ… å¿…é ˆï¼ˆGitèªè¨¼ç”¨ï¼‰ |

---

### 3.3 AIãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½

| æ©Ÿèƒ½ | èª¬æ˜ |
|------|------|
| ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡ | ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒAIã«è³ªå•ãƒ»ä¾é ¼ã‚’é€ä¿¡ |
| AIå¿œç­”è¡¨ç¤º | AIã®å›ç­”ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¡¨ç¤ºï¼ˆã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ï¼‰ |
| ä¼šè©±å±¥æ­´è¡¨ç¤º | éå»ã®ä¼šè©±å±¥æ­´ã‚’è¡¨ç¤ºï¼ˆDBæ°¸ç¶šåŒ–ï¼‰ |
| ä¼šè©±å±¥æ­´æ¤œç´¢ | ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§éå»ã®ãƒãƒ£ãƒƒãƒˆã‚’æ¤œç´¢ |
| Markdownå¯¾å¿œ | AIå¿œç­”ã®Markdownã‚’HTMLã«ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚° |

#### 3.3.1 ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å‡ºåŠ›

AIã®å¿œç­”ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§è¡¨ç¤ºã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã‚’å‘ä¸Šã•ã›ã‚‹ã€‚

**å®Ÿè£…æ–¹å¼**: Server-Sent Events (SSE)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     POST /api/chat      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚            â”‚
â”‚  Frontend  â”‚                          â”‚  Backend   â”‚
â”‚  (React)   â”‚ â—„â”€â”€â”€ SSE Stream â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ (API Route)â”‚
â”‚            â”‚   data: {"text": "æ¤œ"}   â”‚            â”‚
â”‚            â”‚   data: {"text": "ç´¢"}   â”‚     â”‚      â”‚
â”‚            â”‚   data: {"text": "æ©Ÿ"}   â”‚     â–¼      â”‚
â”‚            â”‚   data: {"done": true}   â”‚ Claude Codeâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ãƒ•ãƒ­ãƒ¼**:
1. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãŒPOSTãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡
2. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãŒClaude Codeã‚’å®Ÿè¡Œã—ã€å‡ºåŠ›ã‚’ã‚¹ãƒˆãƒªãƒ¼ãƒ ã§è¿”å´
3. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãŒã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’å—ä¿¡ã—ã€é€æ¬¡è¡¨ç¤º
4. å®Œäº†æ™‚ã« `done: true` ã‚’é€ä¿¡

**ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚¤ãƒ™ãƒ³ãƒˆå½¢å¼**:
```typescript
// ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ£ãƒ³ã‚¯
{ type: 'text', content: 'æ¤œç´¢æ©Ÿèƒ½ã«ã¤ã„ã¦' }

// å®Œäº†
{ type: 'done', sessionId: 'xxx' }

// ã‚¨ãƒ©ãƒ¼
{ type: 'error', message: 'ã‚¨ãƒ©ãƒ¼å†…å®¹' }
```

#### 3.3.2 Markdownãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°

AIå¿œç­”ã«å«ã¾ã‚Œã‚‹Markdownè¨˜æ³•ã‚’HTMLã«å¤‰æ›ã—ã¦è¡¨ç¤ºã™ã‚‹ã€‚

**å¯¾å¿œã™ã‚‹Markdownè¨˜æ³•**:

| è¨˜æ³• | èª¬æ˜ | ä¾‹ |
|------|------|-----|
| è¦‹å‡ºã— | h1ã€œh6 | `# è¦‹å‡ºã—1` |
| å¼·èª¿ | å¤ªå­—ã€æ–œä½“ | `**å¤ªå­—**`, `*æ–œä½“*` |
| ãƒªã‚¹ãƒˆ | ç•ªå·ä»˜ãã€ç®‡æ¡æ›¸ã | `1.`, `-` |
| ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ | ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ãƒã‚¤ãƒ©ã‚¤ãƒˆä»˜ã | ` ```java ` |
| ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚³ãƒ¼ãƒ‰ | ã‚³ãƒ¼ãƒ‰è¨˜æ³• | `` `code` `` |
| ãƒ†ãƒ¼ãƒ–ãƒ« | è¡¨å½¢å¼ | GFMå½¢å¼ |
| ãƒªãƒ³ã‚¯ | ãƒã‚¤ãƒ‘ãƒ¼ãƒªãƒ³ã‚¯ | `[text](url)` |
| å¼•ç”¨ | å¼•ç”¨ãƒ–ãƒ­ãƒƒã‚¯ | `> å¼•ç”¨` |

**ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ãƒã‚¤ãƒ©ã‚¤ãƒˆå¯¾å¿œè¨€èª**:
- JavaScript / TypeScript
- Java
- Python
- SQL
- JSON
- HTML / CSS
- Bash / Shell

**ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**:
```typescript
// components/MarkdownRenderer.tsx
import ReactMarkdown from 'react-markdown'
import remarkGfm from 'remark-gfm'
import { Prism as SyntaxHighlighter } from 'react-syntax-highlighter'
import { oneDark } from 'react-syntax-highlighter/dist/cjs/styles/prism'

interface Props {
  content: string
}

export function MarkdownRenderer({ content }: Props) {
  return (
    <ReactMarkdown
      remarkPlugins={[remarkGfm]}
      components={{
        code({ node, inline, className, children, ...props }) {
          const match = /language-(\w+)/.exec(className || '')
          return !inline && match ? (
            <SyntaxHighlighter
              style={oneDark}
              language={match[1]}
              PreTag="div"
              {...props}
            >
              {String(children).replace(/\n$/, '')}
            </SyntaxHighlighter>
          ) : (
            <code className={className} {...props}>
              {children}
            </code>
          )
        }
      }}
    >
      {content}
    </ReactMarkdown>
  )
}
```

---

### 3.4 å¤–éƒ¨ãƒªãƒã‚¸ãƒˆãƒªé€£æºæ©Ÿèƒ½ï¼ˆMCPï¼‰

#### 3.4.1 æ¦‚è¦

å¤–éƒ¨ã®Gitãƒªãƒã‚¸ãƒˆãƒªã‚µãƒ¼ãƒ“ã‚¹ã¨é€£æºã—ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®å–å¾—ãŠã‚ˆã³Issue/èª²é¡Œã®å–å¾—ã‚’è¡Œã†ã€‚
MVPã§ã¯GitHubã¨Backlogã«å¯¾å¿œã™ã‚‹ã€‚

#### 3.4.2 å¯¾å¿œã‚µãƒ¼ãƒ“ã‚¹æ¯”è¼ƒ

| æ©Ÿèƒ½ | GitHub | Backlog |
|------|--------|---------|
| MCPã‚µãƒ¼ãƒãƒ¼ | GitHub MCP Server | Backlog MCP Serverï¼ˆNulabå…¬å¼ï¼‰ |
| èªè¨¼æ–¹å¼ï¼ˆAPIï¼‰ | Personal Access Token | APIã‚­ãƒ¼ |
| èªè¨¼æ–¹å¼ï¼ˆGitï¼‰ | Personal Access Token | ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ + Gitãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ |
| ãƒªãƒã‚¸ãƒˆãƒªä¸€è¦§å–å¾— | âœ… | âœ… |
| ãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹å–å¾— | âœ…ï¼ˆAPIçµŒç”±ï¼‰ | âœ…ï¼ˆgit cloneçµŒç”±ï¼‰ |
| Issue/èª²é¡Œå–å¾— | âœ… | âœ… |
| ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆå–å¾— | âœ… | âœ… |

#### 3.4.3 GitHubé€£æº

| æ©Ÿèƒ½ | èª¬æ˜ |
|------|------|
| ãƒªãƒã‚¸ãƒˆãƒªæ¥ç¶š | Personal Access Tokenã§èªè¨¼ |
| ã‚³ãƒ¼ãƒ‰å–å¾— | MCPçµŒç”±ã§ãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹ã‚’ç›´æ¥å–å¾— |
| Issueå–å¾— | Issueä¸€è¦§ãƒ»è©³ç´°ã‚’å–å¾— |

**èªè¨¼æ–¹å¼**: Personal Access Tokenï¼ˆPATï¼‰
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒGitHubã§ç™ºè¡Œã—ãŸãƒˆãƒ¼ã‚¯ãƒ³ã‚’ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®šã§å…¥åŠ›
- å¿…è¦ãªã‚¹ã‚³ãƒ¼ãƒ—: `repo`ï¼ˆãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªã®å ´åˆï¼‰

#### 3.4.4 Backlogé€£æº

| æ©Ÿèƒ½ | èª¬æ˜ |
|------|------|
| ãƒªãƒã‚¸ãƒˆãƒªæ¥ç¶š | ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ + Gitãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã§èªè¨¼ |
| ã‚³ãƒ¼ãƒ‰å–å¾— | git cloneçµŒç”±ã§ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³å¾Œã€ãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹ã‚’å–å¾— |
| èª²é¡Œå–å¾— | APIã‚­ãƒ¼èªè¨¼ã§MCPçµŒç”±ã§å–å¾— |

**èªè¨¼æ–¹å¼**:

| ç”¨é€” | èªè¨¼æƒ…å ± |
|------|----------|
| Gitæ“ä½œï¼ˆclone/pullï¼‰ | ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ + Gitãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ |
| APIæ“ä½œï¼ˆèª²é¡Œå–å¾—ç­‰ï¼‰ | APIã‚­ãƒ¼ |

**é‡è¦**: Backlog Gitã®HTTPSèªè¨¼ã«ã¯**APIã‚­ãƒ¼ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“**ã€‚å°‚ç”¨ã®ã€ŒGitãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã€ãŒå¿…è¦ã§ã™ã€‚

#### 3.4.5 ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰å–å¾—æ–¹å¼ã®é•ã„

| æ–¹å¼ | GitHub | Backlog |
|------|--------|---------|
| å–å¾—æ–¹æ³• | MCPçµŒç”±ã§ãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹ã‚’ç›´æ¥å–å¾— | git cloneå¾Œã«ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿å–ã‚Š |
| åˆå›ã‚¢ã‚¯ã‚»ã‚¹ | å³æ™‚ | ã‚¯ãƒ­ãƒ¼ãƒ³æ™‚é–“ãŒå¿…è¦ |
| æ›´æ–°æ™‚ | éƒ½åº¦APIå‘¼ã³å‡ºã— | git pull |
| ã‚­ãƒ£ãƒƒã‚·ãƒ¥ | MCPå´ã§ç®¡ç† | ãƒ­ãƒ¼ã‚«ãƒ«ãƒªãƒã‚¸ãƒˆãƒªã¨ã—ã¦ä¿æŒ |

---

## 4. éæ©Ÿèƒ½è¦ä»¶

### 4.1 æ€§èƒ½è¦ä»¶

| é …ç›® | è¦ä»¶ |
|------|------|
| å¿œç­”æ™‚é–“ | AIå¿œç­”é–‹å§‹ã¾ã§5ç§’ä»¥å†…ï¼ˆã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ï¼‰ |
| èªè¨¼å¿œç­” | Clerkã‚»ãƒƒã‚·ãƒ§ãƒ³æ¤œè¨¼ 50msä»¥å†… |
| DBå¿œç­” | ã‚¯ã‚¨ãƒªå¿œç­” 100msä»¥å†… |
| åŒæ™‚æ¥ç¶š | MVP: è¤‡æ•°ãƒ¦ãƒ¼ã‚¶ãƒ¼å¯¾å¿œï¼ˆClerkç„¡æ–™æ : 10,000 MAUï¼‰ |
| ãƒªãƒã‚¸ãƒˆãƒªã‚¯ãƒ­ãƒ¼ãƒ³ | åˆå›ã‚¯ãƒ­ãƒ¼ãƒ³æ™‚ã¯è¦æ¨¡ã«å¿œã˜ãŸå¾…æ©Ÿæ™‚é–“ã‚’è¨±å®¹ |

### 4.2 ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¦ä»¶

| é …ç›® | MVPå¯¾å¿œ | å‚™è€ƒ |
|------|---------|------|
| ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ | âœ… Clerk | SOC 2 Type IIæº–æ‹  |
| ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç† | âœ… Clerk | JWT + ã‚»ã‚­ãƒ¥ã‚¢Cookie |
| MFA | âœ… Clerkï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰ | äºŒè¦ç´ èªè¨¼å¯¾å¿œ |
| APIã‚­ãƒ¼ç®¡ç† | âœ… DBæš—å·åŒ–ä¿å­˜ | AES-256-GCM |
| é€šä¿¡æš—å·åŒ– | HTTPS | - |
| DBæ¥ç¶š | SSLå¿…é ˆ | Railway PostgreSQL |
| ã‚¯ãƒ­ãƒ¼ãƒ³ãƒªãƒã‚¸ãƒˆãƒª | ä¸€æ™‚ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ | ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº†æ™‚ã«å‰Šé™¤ |
| CSRFå¯¾ç­– | âœ… Clerk | è‡ªå‹•å¯¾å¿œ |
| ãƒœãƒƒãƒˆå¯¾ç­– | âœ… Clerk | AIæ¤œå‡ºæ©Ÿèƒ½ |

### 4.3 é‹ç”¨è¦ä»¶

| é …ç›® | è¦ä»¶ |
|------|------|
| ãƒ‡ãƒ—ãƒ­ã‚¤å…ˆ | Railway |
| èªè¨¼åŸºç›¤ | Clerkï¼ˆãƒãƒãƒ¼ã‚¸ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ï¼‰ |
| ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ | Railway PostgreSQL |
| ç›£è¦– | Railwayæ¨™æº–ãƒ­ã‚° + Clerkãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ |
| ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ— | Railway PostgreSQLè‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ— |
| ãƒ‡ã‚£ã‚¹ã‚¯ç®¡ç† | ã‚¯ãƒ­ãƒ¼ãƒ³ãƒªãƒã‚¸ãƒˆãƒªã®å®šæœŸã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ— |

---

## 5. æŠ€è¡“ä»•æ§˜

### 5.1 æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

| é …ç›® | æŠ€è¡“ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ |
|------|------|-----------|
| ãƒ©ãƒ³ã‚¿ã‚¤ãƒ  | Node.js | v20 LTS |
| ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ | Next.js (App Router) | v15 |
| è¨€èª | TypeScript | 5.x |
| ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚° | Tailwind CSS | v4 |
| çŠ¶æ…‹ç®¡ç† | React hooks + Context | - |
| èªè¨¼ | Clerk | æœ€æ–° |
| ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ | PostgreSQL | 16 |
| ORM | Prisma | 6.x |
| Markdownãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚° | react-markdown | 9.x |
| Markdownæ‹¡å¼µ | remark-gfm | 4.x |
| ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ãƒã‚¤ãƒ©ã‚¤ãƒˆ | react-syntax-highlighter | 15.x |
| AIå®Ÿè¡Œ | Claude Code CLI | æœ€æ–° |
| GitHubé€£æº | GitHub MCP Server | - |
| Backlogé€£æº | Backlog MCP Server (Nulabå…¬å¼) | æœ€æ–° |

### 5.2 ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          Railway                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                  Next.js Application                      â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚   Frontend      â”‚  â”‚        Backend                  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚   (React)       â”‚  â”‚     (API Routes)                â”‚ â”‚  â”‚
â”‚  â”‚  â”‚                 â”‚  â”‚           â”‚                     â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢   â”‚  â”‚  Clerk Middleware               â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  (Clerk UI)     â”‚  â”‚     (èªè¨¼æ¤œè¨¼)                  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚       â”‚         â”‚  â”‚           â”‚                     â”‚ â”‚  â”‚
â”‚  â”‚  â”‚       â–¼         â”‚  â”‚           â–¼                     â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  ãƒãƒ£ãƒƒãƒˆUI     â”‚â—„â”€â”¤  POST /api/chat                 â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†â”‚  â”‚  GET/POST /api/projects         â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚           â”‚                     â”‚ â”‚  â”‚
â”‚  â”‚                       â”‚           â–¼                     â”‚ â”‚  â”‚
â”‚  â”‚                       â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚ â”‚  â”‚
â”‚  â”‚                       â”‚  â”‚   Claude Code     â”‚          â”‚ â”‚  â”‚
â”‚  â”‚                       â”‚  â”‚   (Headless)      â”‚          â”‚ â”‚  â”‚
â”‚  â”‚                       â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚ â”‚  â”‚
â”‚  â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                       â”‚                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              PostgreSQL            â”‚                      â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚  users   â”‚ â”‚ projects â”‚ â”‚ sessions â”‚ â”‚   messages   â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                          â”‚
              â”‚                          â”‚
              â–¼                          â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
    â”‚     Clerk       â”‚                  â”‚
    â”‚  (èªè¨¼ã‚µãƒ¼ãƒ“ã‚¹) â”‚                  â”‚
    â”‚  - ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç† â”‚                  â”‚
    â”‚  - ã‚»ãƒƒã‚·ãƒ§ãƒ³   â”‚                  â”‚
    â”‚  - OAuthé€£æº    â”‚                  â”‚
    â”‚  - Webhook      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ (ãƒ¦ãƒ¼ã‚¶ãƒ¼åŒæœŸ)
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                    â”‚                    â”‚
                    â–¼                    â–¼                    â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚     GitHub      â”‚  â”‚     Backlog     â”‚  â”‚   ãƒ­ãƒ¼ã‚«ãƒ«      â”‚
         â”‚  (MCP Server)   â”‚  â”‚  (MCP Server)   â”‚  â”‚  ãƒªãƒã‚¸ãƒˆãƒª     â”‚
         â”‚  - ãƒªãƒã‚¸ãƒˆãƒª   â”‚  â”‚  - èª²é¡Œ         â”‚  â”‚  (git clone)    â”‚
         â”‚  - Issue        â”‚  â”‚  - ãƒªãƒã‚¸ãƒˆãƒª   â”‚  â”‚                 â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3 ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```
agent-one/
â”œâ”€â”€ prisma/
â”‚   â”œâ”€â”€ schema.prisma             # DBã‚¹ã‚­ãƒ¼ãƒå®šç¾©
â”‚   â””â”€â”€ migrations/               # ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ page.tsx                  # ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒšãƒ¼ã‚¸ï¼ˆæœªèªè¨¼ï¼‰
â”‚   â”‚   â”œâ”€â”€ layout.tsx                # ãƒ«ãƒ¼ãƒˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼ˆClerkProviderï¼‰
â”‚   â”‚   â”œâ”€â”€ sign-in/
â”‚   â”‚   â”‚   â””â”€â”€ [[...sign-in]]/
â”‚   â”‚   â”‚       â””â”€â”€ page.tsx          # ã‚µã‚¤ãƒ³ã‚¤ãƒ³ãƒšãƒ¼ã‚¸
â”‚   â”‚   â”œâ”€â”€ sign-up/
â”‚   â”‚   â”‚   â””â”€â”€ [[...sign-up]]/
â”‚   â”‚   â”‚       â””â”€â”€ page.tsx          # ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—ãƒšãƒ¼ã‚¸
â”‚   â”‚   â”œâ”€â”€ dashboard/
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx              # ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ï¼ˆãƒãƒ£ãƒƒãƒˆUIï¼‰
â”‚   â”‚   â”‚   â””â”€â”€ layout.tsx            # èªè¨¼å¿…é ˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
â”‚   â”‚   â””â”€â”€ api/
â”‚   â”‚       â”œâ”€â”€ chat/
â”‚   â”‚       â”‚   â””â”€â”€ route.ts          # Chat API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”‚       â”œâ”€â”€ projects/
â”‚   â”‚       â”‚   â”œâ”€â”€ route.ts          # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆCRUD
â”‚   â”‚       â”‚   â””â”€â”€ [id]/
â”‚   â”‚       â”‚       â””â”€â”€ route.ts      # å€‹åˆ¥ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ“ä½œ
â”‚   â”‚       â”œâ”€â”€ sessions/
â”‚   â”‚       â”‚   â”œâ”€â”€ route.ts          # ãƒãƒ£ãƒƒãƒˆã‚»ãƒƒã‚·ãƒ§ãƒ³CRUD
â”‚   â”‚       â”‚   â””â”€â”€ [id]/
â”‚   â”‚       â”‚       â””â”€â”€ route.ts      # å€‹åˆ¥ã‚»ãƒƒã‚·ãƒ§ãƒ³æ“ä½œ
â”‚   â”‚       â”œâ”€â”€ repo/
â”‚   â”‚       â”‚   â”œâ”€â”€ clone/
â”‚   â”‚       â”‚   â”‚   â””â”€â”€ route.ts      # Clone API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”‚       â”‚   â””â”€â”€ status/
â”‚   â”‚       â”‚       â””â”€â”€ route.ts      # Status API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”‚       â””â”€â”€ webhooks/
â”‚   â”‚           â””â”€â”€ clerk/
â”‚   â”‚               â””â”€â”€ route.ts      # Clerk Webhookå—ä¿¡
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ ChatInput.tsx             # ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å…¥åŠ›
â”‚   â”‚   â”œâ”€â”€ ChatArea.tsx              # ãƒãƒ£ãƒƒãƒˆã‚¨ãƒªã‚¢
â”‚   â”‚   â”œâ”€â”€ MessageBubble.tsx         # ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
â”‚   â”‚   â”œâ”€â”€ MarkdownRenderer.tsx      # Markdownãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
â”‚   â”‚   â”œâ”€â”€ ProjectList.tsx           # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€è¦§
â”‚   â”‚   â”œâ”€â”€ ProjectModal.tsx          # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ/ç·¨é›†
â”‚   â”‚   â”œâ”€â”€ SessionList.tsx           # ãƒãƒ£ãƒƒãƒˆå±¥æ­´ä¸€è¦§
â”‚   â”‚   â”œâ”€â”€ Header.tsx                # ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆUserButtonå«ã‚€ï¼‰
â”‚   â”‚   â””â”€â”€ AuthGuard.tsx             # èªè¨¼ã‚¬ãƒ¼ãƒ‰ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â””â”€â”€ useChat.ts                # ãƒãƒ£ãƒƒãƒˆã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å‡¦ç†
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ db.ts                     # Prismaã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ claude.ts                 # Claude Codeé€£æº
â”‚   â”‚   â”œâ”€â”€ crypto.ts                 # æš—å·åŒ–ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â”‚   â”œâ”€â”€ mcp/
â”‚   â”‚   â”‚   â”œâ”€â”€ github.ts             # GitHub MCPè¨­å®š
â”‚   â”‚   â”‚   â””â”€â”€ backlog.ts            # Backlog MCPè¨­å®š
â”‚   â”‚   â””â”€â”€ git/
â”‚   â”‚       â””â”€â”€ clone.ts              # git cloneæ“ä½œ
â”‚   â”œâ”€â”€ middleware.ts                 # Clerkèªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢
â”‚   â””â”€â”€ types/
â”‚       â””â”€â”€ index.ts                  # å‹å®šç¾©
â”œâ”€â”€ repos/                            # ã‚¯ãƒ­ãƒ¼ãƒ³ã—ãŸãƒªãƒã‚¸ãƒˆãƒªã®ä¸€æ™‚ä¿å­˜å…ˆ
â”‚   â””â”€â”€ .gitkeep
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ REQUIREMENTS.md               # æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”œâ”€â”€ .env.local                        # ç’°å¢ƒå¤‰æ•°ï¼ˆClerkã‚­ãƒ¼ã€DB URLç­‰ï¼‰
â””â”€â”€ package.json
```

### 5.4 Clerkè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«

**middleware.ts**:
```typescript
import { clerkMiddleware, createRouteMatcher } from '@clerk/nextjs/server'

// èªè¨¼ãŒå¿…è¦ãªãƒ«ãƒ¼ãƒˆ
const isProtectedRoute = createRouteMatcher([
  '/dashboard(.*)',
  '/api/chat(.*)',
  '/api/projects(.*)',
  '/api/sessions(.*)',
  '/api/repo(.*)',
])

export default clerkMiddleware(async (auth, req) => {
  if (isProtectedRoute(req)) {
    await auth.protect()
  }
})

export const config = {
  matcher: [
    '/((?!_next|[^?]*\\.(?:html?|css|js(?!on)|jpe?g|webp|png|gif|svg|ttf|woff2?|ico|csv|docx?|xlsx?|zip|webmanifest)).*)',
    '/(api|trpc)(.*)',
  ],
}
```

**app/layout.tsx**:
```typescript
import { ClerkProvider } from '@clerk/nextjs'
import './globals.css'

export default function RootLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <ClerkProvider>
      <html lang="ja">
        <body>{children}</body>
      </html>
    </ClerkProvider>
  )
}
```

---

## 6. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ

### 6.1 ERå›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      User       â”‚       â”‚              Project                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)         â”‚â”€â”€â”    â”‚ id (PK)                             â”‚
â”‚ clerkId (UQ)    â”‚  â”‚    â”‚ userId (FK) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ email           â”‚  â”‚    â”‚ name                             â”‚  â”‚
â”‚ name            â”‚  â”‚    â”‚ description                      â”‚  â”‚
â”‚ imageUrl        â”‚  â”‚    â”‚ repositoryType                   â”‚  â”‚
â”‚ createdAt       â”‚  â”‚    â”‚ repositoryUrl                    â”‚  â”‚
â”‚ updatedAt       â”‚  â”‚    â”‚ githubToken (encrypted)          â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚ backlogDomain                    â”‚  â”‚
                     â”‚    â”‚ backlogApiKey (encrypted)        â”‚  â”‚
                     â”‚    â”‚ backlogProjectKey                â”‚  â”‚
                     â”‚    â”‚ backlogEmail                     â”‚  â”‚
                     â”‚    â”‚ backlogGitPassword (encrypted)   â”‚  â”‚
                     â”‚    â”‚ createdAt                        â”‚  â”‚
                     â”‚    â”‚ updatedAt                        â”‚  â”‚
                     â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚    â”‚           ChatSession               â”‚
                     â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                     â”‚    â”‚ id (PK)                             â”‚
                     â””â”€â”€â”€â–ºâ”‚ userId (FK)                         â”‚
                          â”‚ projectId (FK) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                          â”‚ title                               â”‚
                          â”‚ createdAt                           â”‚
                          â”‚ updatedAt                           â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                            â”‚
                                            â”‚
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚             Message                 â”‚
                          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                          â”‚ id (PK)                             â”‚
                          â”‚ sessionId (FK) â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚ role (user/assistant)               â”‚
                          â”‚ content                             â”‚
                          â”‚ createdAt                           â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 Prismaã‚¹ã‚­ãƒ¼ãƒ

```prisma
// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆClerkã¨åŒæœŸï¼‰
model User {
  id        String   @id @default(cuid())
  clerkId   String   @unique
  email     String   @unique
  name      String?
  imageUrl  String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  projects     Project[]
  chatSessions ChatSession[]

  @@map("users")
}

// ãƒªãƒã‚¸ãƒˆãƒªã‚¿ã‚¤ãƒ—
enum RepositoryType {
  github
  backlog
}

// ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ
model Project {
  id             String         @id @default(cuid())
  userId         String
  name           String
  description    String?
  repositoryType RepositoryType
  repositoryUrl  String

  // GitHubèªè¨¼æƒ…å ±ï¼ˆæš—å·åŒ–ä¿å­˜ï¼‰
  githubToken String?

  // Backlogèªè¨¼æƒ…å ±ï¼ˆæš—å·åŒ–ä¿å­˜ï¼‰
  backlogDomain      String?
  backlogApiKey      String?
  backlogProjectKey  String?
  backlogEmail       String?
  backlogGitPassword String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user         User          @relation(fields: [userId], references: [id], onDelete: Cascade)
  chatSessions ChatSession[]

  @@index([userId])
  @@map("projects")
}

// ãƒãƒ£ãƒƒãƒˆã‚»ãƒƒã‚·ãƒ§ãƒ³
model ChatSession {
  id        String   @id @default(cuid())
  userId    String
  projectId String
  title     String   @default("New Chat")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user     User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  project  Project   @relation(fields: [projectId], references: [id], onDelete: Cascade)
  messages Message[]

  @@index([userId])
  @@index([projectId])
  @@map("chat_sessions")
}

// ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ«
enum MessageRole {
  user
  assistant
}

// ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
model Message {
  id        String      @id @default(cuid())
  sessionId String
  role      MessageRole
  content   String
  createdAt DateTime    @default(now())

  session ChatSession @relation(fields: [sessionId], references: [id], onDelete: Cascade)

  @@index([sessionId])
  @@map("messages")
}
```

### 6.3 æ©Ÿå¯†æƒ…å ±ã®æš—å·åŒ–

APIã‚­ãƒ¼ã‚„ãƒˆãƒ¼ã‚¯ãƒ³ãªã©ã®æ©Ÿå¯†æƒ…å ±ã¯AES-256-GCMã§æš—å·åŒ–ã—ã¦ä¿å­˜ã™ã‚‹ã€‚

```typescript
// src/lib/crypto.ts
import { createCipheriv, createDecipheriv, randomBytes } from 'crypto';

const ENCRYPTION_KEY = process.env.ENCRYPTION_KEY!; // 32ãƒã‚¤ãƒˆ
const ALGORITHM = 'aes-256-gcm';

export function encrypt(text: string): string {
  const iv = randomBytes(16);
  const cipher = createCipheriv(ALGORITHM, Buffer.from(ENCRYPTION_KEY, 'hex'), iv);
  let encrypted = cipher.update(text, 'utf8', 'hex');
  encrypted += cipher.final('hex');
  const authTag = cipher.getAuthTag();
  return `${iv.toString('hex')}:${authTag.toString('hex')}:${encrypted}`;
}

export function decrypt(encryptedText: string): string {
  const [ivHex, authTagHex, encrypted] = encryptedText.split(':');
  const iv = Buffer.from(ivHex, 'hex');
  const authTag = Buffer.from(authTagHex, 'hex');
  const decipher = createDecipheriv(ALGORITHM, Buffer.from(ENCRYPTION_KEY, 'hex'), iv);
  decipher.setAuthTag(authTag);
  let decrypted = decipher.update(encrypted, 'hex', 'utf8');
  decrypted += decipher.final('utf8');
  return decrypted;
}
```

---

## 7. ç”»é¢è¨­è¨ˆ

### 7.1 ç”»é¢é·ç§»å›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°   â”‚
â”‚    ãƒšãƒ¼ã‚¸       â”‚
â”‚   (æœªèªè¨¼)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ã‚µã‚¤ãƒ³ã‚¤ãƒ³    â”‚â—„â”€â”€â”€â–ºâ”‚   ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—  â”‚
â”‚    ãƒšãƒ¼ã‚¸       â”‚     â”‚     ãƒšãƒ¼ã‚¸      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼ (èªè¨¼æˆåŠŸ)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ â”‚
â”‚  (ãƒ¡ã‚¤ãƒ³ç”»é¢)   â”‚
â”‚  - ãƒãƒ£ãƒƒãƒˆ     â”‚
â”‚  - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ â”‚
â”‚  - å±¥æ­´ä¸€è¦§     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 ç”»é¢æ§‹æˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AGENT-One          [ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé¸æŠ â–¼]        ğŸ‘¤ UserButton  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚             â”‚                                                   â”‚
â”‚ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ â”‚            ãƒãƒ£ãƒƒãƒˆã‚¨ãƒªã‚¢                         â”‚
â”‚ ä¸€è¦§        â”‚                                                   â”‚
â”‚             â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  â”‚ ğŸ‘¤ ã“ã®ã‚¢ãƒ—ãƒªã®æ¤œç´¢æ©Ÿèƒ½ã®                    â”‚  â”‚
â”‚ ğŸ™ Project Aâ”‚  â”‚    ä½¿ã„æ–¹ã‚’æ•™ãˆã¦                            â”‚  â”‚
â”‚ ğŸ“‹ Project Bâ”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚             â”‚  â”‚ ğŸ¤– æ¤œç´¢æ©Ÿèƒ½ã«ã¤ã„ã¦è§£æã—ã¾ã—ãŸ...           â”‚  â”‚
â”‚ [+ æ–°è¦]    â”‚  â”‚                                             â”‚  â”‚
â”‚             â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚                                                   â”‚
â”‚ å±¥æ­´        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  â”‚ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›...                  [é€ä¿¡] â”‚  â”‚
â”‚ ğŸ“ æ¤œç´¢æ©Ÿèƒ½â€¦ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚ ğŸ“ CSVå‡ºåŠ›â€¦ â”‚                                                   â”‚
â”‚ ğŸ“ ãƒã‚°èª¿æŸ»â€¦â”‚                                                   â”‚
â”‚             â”‚                                                   â”‚
â”‚ å‡¡ä¾‹:       â”‚                                                   â”‚
â”‚ ğŸ™ GitHub   â”‚                                                   â”‚
â”‚ ğŸ“‹ Backlog  â”‚                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.3 ç”»é¢ä¸€è¦§

| ç”»é¢ | ãƒ‘ã‚¹ | èªè¨¼ | æ©Ÿèƒ½ |
|------|------|------|------|
| ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒšãƒ¼ã‚¸ | `/` | ä¸è¦ | ã‚µãƒ¼ãƒ“ã‚¹ç´¹ä»‹ã€ãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³ |
| ã‚µã‚¤ãƒ³ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ | `/sign-in` | ä¸è¦ | Clerkã‚µã‚¤ãƒ³ã‚¤ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ |
| ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—ãƒšãƒ¼ã‚¸ | `/sign-up` | ä¸è¦ | Clerkã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ |
| ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ | `/dashboard` | **å¿…è¦** | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€è¦§ + ãƒãƒ£ãƒƒãƒˆ + å±¥æ­´ |
| ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆãƒ¢ãƒ¼ãƒ€ãƒ« | - | **å¿…è¦** | æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç™»éŒ² |
| ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ« | - | **å¿…è¦** | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæƒ…å ±å¤‰æ›´ |

### 7.4 ã‚µã‚¤ãƒ³ã‚¤ãƒ³ãƒšãƒ¼ã‚¸

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚                      AGENT-One                              â”‚
â”‚                                                             â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚              â”‚                           â”‚                  â”‚
â”‚              â”‚     Sign in to AGENT-One  â”‚                  â”‚
â”‚              â”‚                           â”‚                  â”‚
â”‚              â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                  â”‚
â”‚              â”‚  â”‚ Continue with Googleâ”‚  â”‚                  â”‚
â”‚              â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                  â”‚
â”‚              â”‚                           â”‚                  â”‚
â”‚              â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                  â”‚
â”‚              â”‚  â”‚ Continue with GitHubâ”‚  â”‚                  â”‚
â”‚              â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                  â”‚
â”‚              â”‚                           â”‚                  â”‚
â”‚              â”‚  â”€â”€â”€â”€â”€â”€â”€ or â”€â”€â”€â”€â”€â”€â”€       â”‚                  â”‚
â”‚              â”‚                           â”‚                  â”‚
â”‚              â”‚  Email                    â”‚                  â”‚
â”‚              â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                  â”‚
â”‚              â”‚  â”‚                     â”‚  â”‚                  â”‚
â”‚              â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                  â”‚
â”‚              â”‚                           â”‚                  â”‚
â”‚              â”‚  Password                 â”‚                  â”‚
â”‚              â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                  â”‚
â”‚              â”‚  â”‚ â—â—â—â—â—â—â—â—            â”‚  â”‚                  â”‚
â”‚              â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                  â”‚
â”‚              â”‚                           â”‚                  â”‚
â”‚              â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                  â”‚
â”‚              â”‚  â”‚      Sign in        â”‚  â”‚                  â”‚
â”‚              â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                  â”‚
â”‚              â”‚                           â”‚                  â”‚
â”‚              â”‚  Don't have an account?   â”‚                  â”‚
â”‚              â”‚  Sign up                  â”‚                  â”‚
â”‚              â”‚                           â”‚                  â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 8. APIè¨­è¨ˆ

### 8.1 ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä¸€è¦§

| ãƒ¡ã‚½ãƒƒãƒ‰ | ãƒ‘ã‚¹ | èªè¨¼ | èª¬æ˜ |
|---------|------|------|------|
| GET | `/api/projects` | âœ… | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€è¦§å–å¾— |
| POST | `/api/projects` | âœ… | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ |
| GET | `/api/projects/[id]` | âœ… | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè©³ç´°å–å¾— |
| PUT | `/api/projects/[id]` | âœ… | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ›´æ–° |
| DELETE | `/api/projects/[id]` | âœ… | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå‰Šé™¤ |
| GET | `/api/sessions` | âœ… | ãƒãƒ£ãƒƒãƒˆã‚»ãƒƒã‚·ãƒ§ãƒ³ä¸€è¦§å–å¾— |
| POST | `/api/sessions` | âœ… | ãƒãƒ£ãƒƒãƒˆã‚»ãƒƒã‚·ãƒ§ãƒ³ä½œæˆ |
| GET | `/api/sessions/[id]` | âœ… | ã‚»ãƒƒã‚·ãƒ§ãƒ³è©³ç´°ï¼ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å«ã‚€ï¼‰ |
| DELETE | `/api/sessions/[id]` | âœ… | ã‚»ãƒƒã‚·ãƒ§ãƒ³å‰Šé™¤ |
| POST | `/api/chat` | âœ… | AIã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ |
| POST | `/api/repo/clone` | âœ… | ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ |
| GET | `/api/repo/status` | âœ… | ã‚¯ãƒ­ãƒ¼ãƒ³çŠ¶æ…‹ã‚’ç¢ºèª |
| POST | `/api/webhooks/clerk` | - | Clerk Webhookå—ä¿¡ |

### 8.2 èªè¨¼æ¤œè¨¼ï¼ˆå…±é€šï¼‰

```typescript
import { auth } from '@clerk/nextjs/server'
import { prisma } from '@/lib/db'

export async function getAuthenticatedUser() {
  const { userId } = await auth()
  
  if (!userId) {
    throw new Error('Unauthorized')
  }
  
  const user = await prisma.user.findUnique({
    where: { clerkId: userId }
  })
  
  if (!user) {
    throw new Error('User not found')
  }
  
  return user
}
```

### 8.3 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆAPI

#### GET /api/projects

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:
```typescript
interface ProjectListResponse {
  projects: {
    id: string;
    name: string;
    description: string | null;
    repositoryType: 'github' | 'backlog';
    repositoryUrl: string;
    createdAt: string;
    updatedAt: string;
  }[];
}
```

#### POST /api/projects

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**:
```typescript
interface CreateProjectRequest {
  name: string;
  description?: string;
  repositoryType: 'github' | 'backlog';
  repositoryUrl: string;
  // GitHub
  githubToken?: string;
  // Backlog
  backlogDomain?: string;
  backlogApiKey?: string;
  backlogProjectKey?: string;
  backlogEmail?: string;
  backlogGitPassword?: string;
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:
```typescript
interface CreateProjectResponse {
  project: {
    id: string;
    name: string;
    // ...
  };
}
```

### 8.4 ãƒãƒ£ãƒƒãƒˆã‚»ãƒƒã‚·ãƒ§ãƒ³API

#### GET /api/sessions

**ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**:
```typescript
interface SessionListQuery {
  projectId?: string;  // ãƒ•ã‚£ãƒ«ã‚¿ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
  limit?: number;      // å–å¾—ä»¶æ•°ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 20ï¼‰
  cursor?: string;     // ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:
```typescript
interface SessionListResponse {
  sessions: {
    id: string;
    title: string;
    projectId: string;
    projectName: string;
    createdAt: string;
    updatedAt: string;
  }[];
  nextCursor?: string;
}
```

#### GET /api/sessions/[id]

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:
```typescript
interface SessionDetailResponse {
  session: {
    id: string;
    title: string;
    projectId: string;
    messages: {
      id: string;
      role: 'user' | 'assistant';
      content: string;
      createdAt: string;
    }[];
  };
}
```

### 8.5 ãƒãƒ£ãƒƒãƒˆAPI

#### POST /api/chat

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**:
```typescript
interface ChatRequest {
  message: string;      // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
  projectId: string;    // å¯¾è±¡ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆID
  sessionId?: string;   // æ—¢å­˜ã‚»ãƒƒã‚·ãƒ§ãƒ³IDï¼ˆæ–°è¦ã®å ´åˆã¯çœç•¥ï¼‰
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**: Server-Sent Events (SSE) ã‚¹ãƒˆãƒªãƒ¼ãƒ 

```typescript
// Content-Type: text/event-stream

// ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ£ãƒ³ã‚¯ï¼ˆè¤‡æ•°å›é€ä¿¡ï¼‰
data: {"type":"text","content":"æ¤œç´¢æ©Ÿèƒ½ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚"}

data: {"type":"text","content":"\n\n## ä½¿ã„æ–¹\n"}

data: {"type":"text","content":"1. ãƒ˜ãƒƒãƒ€ãƒ¼ã®æ¤œç´¢ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯"}

// å®Œäº†ã‚¤ãƒ™ãƒ³ãƒˆ
data: {"type":"done","sessionId":"clxxx..."}

// ã‚¨ãƒ©ãƒ¼æ™‚
data: {"type":"error","message":"Claude Codeå®Ÿè¡Œã‚¨ãƒ©ãƒ¼"}
```

**ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚¤ãƒ™ãƒ³ãƒˆå‹å®šç¾©**:
```typescript
type StreamEvent =
  | { type: 'text'; content: string }
  | { type: 'done'; sessionId: string }
  | { type: 'error'; message: string }
```

**ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Ÿè£…ä¾‹**:
```typescript
// hooks/useChat.ts
export function useChat() {
  const [messages, setMessages] = useState<Message[]>([])
  const [isLoading, setIsLoading] = useState(false)

  const sendMessage = async (content: string, projectId: string, sessionId?: string) => {
    setIsLoading(true)
    
    // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ 
    const userMessage: Message = {
      id: crypto.randomUUID(),
      role: 'user',
      content,
      timestamp: new Date().toISOString(),
    }
    setMessages(prev => [...prev, userMessage])

    // ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã‚’è¿½åŠ 
    const assistantMessage: Message = {
      id: crypto.randomUUID(),
      role: 'assistant',
      content: '',
      timestamp: new Date().toISOString(),
    }
    setMessages(prev => [...prev, assistantMessage])

    try {
      const response = await fetch('/api/chat', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ message: content, projectId, sessionId }),
      })

      const reader = response.body?.getReader()
      const decoder = new TextDecoder()

      while (reader) {
        const { done, value } = await reader.read()
        if (done) break

        const chunk = decoder.decode(value)
        const lines = chunk.split('\n').filter(line => line.startsWith('data: '))

        for (const line of lines) {
          const data = JSON.parse(line.slice(6)) as StreamEvent
          
          if (data.type === 'text') {
            // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€æ¬¡æ›´æ–°
            setMessages(prev => {
              const updated = [...prev]
              const lastIndex = updated.length - 1
              updated[lastIndex] = {
                ...updated[lastIndex],
                content: updated[lastIndex].content + data.content,
              }
              return updated
            })
          } else if (data.type === 'done') {
            // å®Œäº†å‡¦ç†
            return data.sessionId
          } else if (data.type === 'error') {
            throw new Error(data.message)
          }
        }
      }
    } finally {
      setIsLoading(false)
    }
  }

  return { messages, isLoading, sendMessage }
}
```

**ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å®Ÿè£…ä¾‹**:
```typescript
// app/api/chat/route.ts
import { auth } from '@clerk/nextjs/server'
import { NextRequest } from 'next/server'

export async function POST(req: NextRequest) {
  const { userId } = await auth()
  if (!userId) {
    return new Response('Unauthorized', { status: 401 })
  }

  const { message, projectId, sessionId } = await req.json()

  // ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’ä½œæˆ
  const encoder = new TextEncoder()
  const stream = new ReadableStream({
    async start(controller) {
      try {
        // Claude Codeå®Ÿè¡Œï¼ˆã‚¹ãƒˆãƒªãƒ¼ãƒ å‡ºåŠ›ï¼‰
        const process = spawn('claude', [
          '--print', message,
          '--output-format', 'stream-json',
        ])

        process.stdout.on('data', (data: Buffer) => {
          const text = data.toString()
          controller.enqueue(
            encoder.encode(`data: ${JSON.stringify({ type: 'text', content: text })}\n\n`)
          )
        })

        process.on('close', async () => {
          // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’DBã«ä¿å­˜
          const newSessionId = await saveToDatabase(userId, projectId, sessionId, message, fullResponse)
          
          controller.enqueue(
            encoder.encode(`data: ${JSON.stringify({ type: 'done', sessionId: newSessionId })}\n\n`)
          )
          controller.close()
        })

        process.on('error', (err) => {
          controller.enqueue(
            encoder.encode(`data: ${JSON.stringify({ type: 'error', message: err.message })}\n\n`)
          )
          controller.close()
        })
      } catch (error) {
        controller.enqueue(
          encoder.encode(`data: ${JSON.stringify({ type: 'error', message: 'Internal error' })}\n\n`)
        )
        controller.close()
      }
    },
  })

  return new Response(stream, {
    headers: {
      'Content-Type': 'text/event-stream',
      'Cache-Control': 'no-cache',
      'Connection': 'keep-alive',
    },
  })
}
```

### 8.6 Clerk Webhook

#### POST /api/webhooks/clerk

Clerkã‹ã‚‰ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆ/æ›´æ–°/å‰Šé™¤ã‚¤ãƒ™ãƒ³ãƒˆã‚’å—ä¿¡ã—ã€DBã¨åŒæœŸã™ã‚‹ã€‚

```typescript
// Webhookã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†
switch (event.type) {
  case 'user.created':
    await prisma.user.create({
      data: {
        clerkId: event.data.id,
        email: event.data.email_addresses[0].email_address,
        name: `${event.data.first_name} ${event.data.last_name}`.trim(),
        imageUrl: event.data.image_url,
      }
    });
    break;
  case 'user.updated':
    await prisma.user.update({
      where: { clerkId: event.data.id },
      data: { /* ... */ }
    });
    break;
  case 'user.deleted':
    await prisma.user.delete({
      where: { clerkId: event.data.id }
    });
    break;
}
```

---

## 9. å°†æ¥æ‹¡å¼µ

### 9.1 Phase 2ï¼ˆæ©Ÿèƒ½æ‹¡å¼µï¼‰

- GitLabå¯¾å¿œ
- Bitbucketå¯¾å¿œ
- ãƒ¬ãƒãƒ¼ãƒˆå‡ºåŠ›æ©Ÿèƒ½ï¼ˆPDF/Excelï¼‰
- ãƒãƒ£ãƒƒãƒˆå±¥æ­´ã®å…¨æ–‡æ¤œç´¢ï¼ˆPostgreSQL Full Text Searchï¼‰

### 9.2 Phase 3ï¼ˆãƒãƒ¼ãƒ æ©Ÿèƒ½ï¼‰

- Clerk Organizationsï¼ˆãƒãƒ¼ãƒ ç®¡ç†ï¼‰
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…±æœ‰æ©Ÿèƒ½
- æ¨©é™ç®¡ç†ï¼ˆé–²è¦§è€…/ç·¨é›†è€…/ç®¡ç†è€…ï¼‰
- ç›£æŸ»ãƒ­ã‚°

---

## 10. ç”¨èªé›†

| ç”¨èª | èª¬æ˜ |
|------|------|
| MCP | Model Context Protocolã€‚AIã¨ãƒ„ãƒ¼ãƒ«ã‚’æ¥ç¶šã™ã‚‹ãƒ—ãƒ­ãƒˆã‚³ãƒ« |
| Claude Code | Anthropicç¤¾ã®AIã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ„ãƒ¼ãƒ« |
| PAT | Personal Access Tokenã€‚GitHub APIã®èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ |
| Railway | PaaSã‚µãƒ¼ãƒ“ã‚¹ã€‚ã‚¢ãƒ—ãƒªã®ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°å…ˆ |
| Backlog | Nulabç¤¾ãŒæä¾›ã™ã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†ãƒ„ãƒ¼ãƒ«ã€‚Gitæ©Ÿèƒ½ã‚’å†…è”µ |
| APIã‚­ãƒ¼ | Backlog APIã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã®èªè¨¼ã‚­ãƒ¼ |
| ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚­ãƒ¼ | Backlogãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’è­˜åˆ¥ã™ã‚‹ä¸€æ„ã®ã‚­ãƒ¼ï¼ˆä¾‹: MYAPPï¼‰ |
| Gitãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ | Backlog Gitã®HTTPSèªè¨¼ç”¨ã«ç™ºè¡Œã™ã‚‹å°‚ç”¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ |
| Clerk | èªè¨¼ãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ã®ãƒãƒãƒ¼ã‚¸ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ |
| MAU | Monthly Active Usersã€‚æœˆé–“ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•° |
| OAuth | å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½¿ã£ãŸèªè¨¼ãƒ—ãƒ­ãƒˆã‚³ãƒ«ï¼ˆGoogleã€GitHubç­‰ï¼‰ |
| Prisma | TypeScriptå¯¾å¿œã®ORMï¼ˆObject-Relational Mappingï¼‰ |
| PostgreSQL | ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã®ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒŠãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ |
| Webhook | ã‚¤ãƒ™ãƒ³ãƒˆç™ºç”Ÿæ™‚ã«å¤–éƒ¨URLã¸HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ä»•çµ„ã¿ |

---

## æ”¹è¨‚å±¥æ­´

| æ—¥ä»˜ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å¤‰æ›´å†…å®¹ |
|------|-----------|---------|
| 2025å¹´1æœˆ | 1.0 | åˆç‰ˆä½œæˆ |
| 2025å¹´1æœˆ | 1.1 | Backlog Gitå¯¾å¿œã‚’è¿½åŠ ï¼ˆMVPç¯„å›²ï¼‰ |
| 2025å¹´1æœˆ | 1.2 | Backlogèªè¨¼æƒ…å ±ã®å–å¾—æ–¹æ³•ã‚’è¿½è¨˜ã€Projectå‹ã‚’æ›´æ–° |
| 2025å¹´1æœˆ | 1.3 | Clerkèªè¨¼ã¨PostgreSQL + Prismaã‚’è¿½åŠ ã€Markdownãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã¨ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å‡ºåŠ›ã‚’è¿½åŠ ï¼ˆMVPç¯„å›²ï¼‰ |

---

## ä»˜éŒ²A: Backlogèªè¨¼æƒ…å ±ã®å–å¾—æ–¹æ³•

Backlogé€£æºã«ã¯**2ç¨®é¡ã®èªè¨¼æƒ…å ±**ãŒå¿…è¦ã§ã™ã€‚ç”¨é€”ãŒç•°ãªã‚‹ãŸã‚ã€ãã‚Œãã‚Œåˆ¥ã€…ã«å–å¾—ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

### A.1 èªè¨¼æƒ…å ±ã®ç¨®é¡ã¨ç”¨é€”

| èªè¨¼æƒ…å ± | ç”¨é€” | å–å¾—å ´æ‰€ |
|----------|------|----------|
| APIã‚­ãƒ¼ | èª²é¡Œå–å¾—ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæƒ…å ±å–å¾— | å€‹äººè¨­å®š > API |
| Gitãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ | git cloneã€git pull | å€‹äººè¨­å®š > ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ |
| ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ | Gitèªè¨¼ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼å | ãƒŒãƒ¼ãƒ©ãƒœã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ |

**é‡è¦**: APIã‚­ãƒ¼ã§ã¯Gitæ“ä½œï¼ˆclone/pullï¼‰ã¯ã§ãã¾ã›ã‚“ã€‚å¿…ãšGitãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚

---

### A.2 Backlogãƒ‰ãƒ¡ã‚¤ãƒ³

**æ¦‚è¦**: Backlogã‚¹ãƒšãƒ¼ã‚¹ã®URLã®ãƒ‰ãƒ¡ã‚¤ãƒ³éƒ¨åˆ†

**ç¢ºèªæ–¹æ³•**:
1. Backlogã«ãƒ­ã‚°ã‚¤ãƒ³
2. ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒãƒ¼ã‚’ç¢ºèª
3. URLã®å½¢å¼ã‹ã‚‰å–å¾—

**ä¾‹**:
| URL | backlogDomain |
|-----|---------------|
| `https://mycompany.backlog.com/` | `mycompany.backlog.com` |
| `https://mycompany.backlog.jp/` | `mycompany.backlog.jp` |

---

### A.3 APIã‚­ãƒ¼ã®å–å¾—æ‰‹é †

**ç”¨é€”**: Backlog APIï¼ˆèª²é¡Œå–å¾—ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæƒ…å ±å–å¾—ç­‰ï¼‰

**å–å¾—æ‰‹é †**:

```
1. Backlogã«ãƒ­ã‚°ã‚¤ãƒ³

2. å³ä¸Šã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯

3. ã€Œå€‹äººè¨­å®šã€ã‚’é¸æŠ

4. å·¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã€ŒAPIã€ã‚’ã‚¯ãƒªãƒƒã‚¯

5. ã€Œãƒ¡ãƒ¢ã€æ¬„ã«ç”¨é€”ã‚’å…¥åŠ›ï¼ˆä¾‹ï¼šã€ŒAGENT-Oneé€£æºç”¨ã€ï¼‰

6. ã€Œç™»éŒ²ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯

7. ç™ºè¡Œã•ã‚ŒãŸAPIã‚­ãƒ¼æ–‡å­—åˆ—ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ä¿å­˜
```

**ç”»é¢é·ç§»**:
```
å³ä¸Šã‚¢ã‚¤ã‚³ãƒ³ â†’ å€‹äººè¨­å®š â†’ API â†’ ãƒ¡ãƒ¢å…¥åŠ› â†’ ç™»éŒ²
```

---

### A.4 Gitãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®å–å¾—æ‰‹é †

**ç”¨é€”**: Gitæ“ä½œï¼ˆcloneã€pullã€pushç­‰ï¼‰ã®HTTPSèªè¨¼

**å–å¾—æ‰‹é †**:

```
1. Backlogã«ãƒ­ã‚°ã‚¤ãƒ³

2. å³ä¸Šã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯

3. ã€Œå€‹äººè¨­å®šã€ã‚’é¸æŠ

4. å·¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã€Œãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã€ã‚’ã‚¯ãƒªãƒƒã‚¯

5. ã€Œãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ä½œæˆã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯

6. ä½œæˆã•ã‚ŒãŸãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ä¿å­˜
```

**ç”»é¢é·ç§»**:
```
å³ä¸Šã‚¢ã‚¤ã‚³ãƒ³ â†’ å€‹äººè¨­å®š â†’ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ â†’ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ä½œæˆ
```

**é‡è¦**:
- ã“ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯**APIã‚­ãƒ¼ã¨ã¯åˆ¥ç‰©**ã§ã™
- Gitæ“ä½œå°‚ç”¨ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¨ã—ã¦ä½¿ç”¨ã—ã¾ã™
- 2æ®µéšèªè¨¼ã‚’è¨­å®šã—ã¦ã„ã‚‹å ´åˆã¯å¿…é ˆã§ã™

---

### A.5 ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆGitèªè¨¼ç”¨ãƒ¦ãƒ¼ã‚¶ãƒ¼åï¼‰

**ç”¨é€”**: Gitèªè¨¼æ™‚ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¨ã—ã¦ä½¿ç”¨

**ç¢ºèªæ–¹æ³•**:

ãƒŒãƒ¼ãƒ©ãƒœã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã‚‹å ´åˆï¼š
- **ãƒŒãƒ¼ãƒ©ãƒœã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹**ã‚’ä½¿ç”¨

Backlogã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã‚‹å ´åˆï¼š
- **Backlogã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ID**ã‚’ä½¿ç”¨

**ç¢ºèªå ´æ‰€**:
```
å³ä¸Šã‚¢ã‚¤ã‚³ãƒ³ â†’ å€‹äººè¨­å®š â†’ ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±
```

---

### A.6 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚­ãƒ¼

**æ¦‚è¦**: Backlogãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’è­˜åˆ¥ã™ã‚‹ä¸€æ„ã®ã‚­ãƒ¼

**ç¢ºèªæ–¹æ³•**:

#### æ–¹æ³•1: èª²é¡Œã‚­ãƒ¼ã‹ã‚‰ç¢ºèª
èª²é¡Œã®ä¸€è¦§ã‚„è©³ç´°ç”»é¢ã§è¡¨ç¤ºã•ã‚Œã‚‹èª²é¡Œã‚­ãƒ¼ã®**ãƒã‚¤ãƒ•ãƒ³å‰ã®éƒ¨åˆ†**ãŒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚­ãƒ¼

```
èª²é¡Œã‚­ãƒ¼: MYAPP-123
         â†“
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚­ãƒ¼: MYAPP
```

#### æ–¹æ³•2: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®šURLã‹ã‚‰ç¢ºèª
```
URLä¾‹: https://mycompany.backlog.com/projects/MYAPP
                                          â†‘
                              ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚­ãƒ¼: MYAPP
```

---

### A.7 ãƒªãƒã‚¸ãƒˆãƒªURL

**æ¦‚è¦**: git cloneæ™‚ã«ä½¿ç”¨ã™ã‚‹HTTPS URL

**ç¢ºèªæ–¹æ³•**:

```
1. Backlogã«ãƒ­ã‚°ã‚¤ãƒ³

2. å¯¾è±¡ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é–‹ã

3. ã€ŒGitã€ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’ã‚¯ãƒªãƒƒã‚¯

4. å¯¾è±¡ãƒªãƒã‚¸ãƒˆãƒªã‚’é¸æŠ

5. ã€ŒHTTPSã€ã‚¿ãƒ–ã‚’é¸æŠ

6. è¡¨ç¤ºã•ã‚ŒãŸURLã‚’ã‚³ãƒ”ãƒ¼
```

**URLå½¢å¼**:
```
https://{domain}/git/{projectKey}/{repositoryName}.git

ä¾‹: https://mycompany.backlog.com/git/MYAPP/backend.git
```

---

### A.8 è¨­å®šå€¤ã¾ã¨ã‚

```typescript
// Backlogãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­å®šä¾‹
const backlogConfig = {
  backlogDomain: "mycompany.backlog.com",           // â‘  ã‚¹ãƒšãƒ¼ã‚¹URL
  backlogProjectKey: "MYAPP",                       // â‘¡ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚­ãƒ¼
  repositoryUrl: "https://mycompany.backlog.com/git/MYAPP/backend.git", // â‘¢ ãƒªãƒã‚¸ãƒˆãƒªURL
  backlogApiKey: "AbCdEfGhIjKlMnOpQrStUvWxYz...",  // â‘£ å€‹äººè¨­å®š > API
  backlogEmail: "user@example.com",                 // â‘¤ ãƒŒãƒ¼ãƒ©ãƒœã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹
  backlogGitPassword: "XyZ123AbC456DeF789..."       // â‘¥ å€‹äººè¨­å®š > ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰
};
```

---

### A.9 ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

| ã‚¨ãƒ©ãƒ¼ | åŸå›  | å¯¾å‡¦æ³• |
|--------|------|--------|
| `remote: Unauthorized` | èªè¨¼æƒ…å ±ãŒæ­£ã—ããªã„ | ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨Gitãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å†ç¢ºèª |
| `Authentication failed` | APIã‚­ãƒ¼ã‚’Gitèªè¨¼ã«ä½¿ç”¨ã—ã¦ã„ã‚‹ | Gitãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã™ã‚‹ |
| èª²é¡ŒãŒå–å¾—ã§ããªã„ | APIã‚­ãƒ¼ãŒç„¡åŠ¹ã¾ãŸã¯æ¨©é™ä¸è¶³ | APIã‚­ãƒ¼ã‚’å†ç™ºè¡Œã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¡ãƒ³ãƒãƒ¼ç¢ºèª |

---

## ä»˜éŒ²B: Backlog MCP Serverè¨­å®šä¾‹

### Dockerå®Ÿè¡Œ

```json
{
  "mcpServers": {
    "backlog": {
      "command": "docker",
      "args": [
        "run",
        "--pull", "always",
        "-i",
        "--rm",
        "-e", "BACKLOG_DOMAIN",
        "-e", "BACKLOG_API_KEY"
      ],
      "env": {
        "BACKLOG_DOMAIN": "your-domain.backlog.com",
        "BACKLOG_API_KEY": "your-api-key"
      }
    }
  }
}
```

### npxå®Ÿè¡Œ

```json
{
  "mcpServers": {
    "backlog": {
      "command": "npx",
      "args": ["backlog-mcp-server"],
      "env": {
        "BACKLOG_DOMAIN": "your-domain.backlog.com",
        "BACKLOG_API_KEY": "your-api-key"
      }
    }
  }
}
```

### åˆ©ç”¨å¯èƒ½ãªãƒ„ãƒ¼ãƒ«ã‚»ãƒƒãƒˆ

| ãƒ„ãƒ¼ãƒ«ã‚»ãƒƒãƒˆ | èª¬æ˜ |
|-------------|------|
| space | ã‚¹ãƒšãƒ¼ã‚¹è¨­å®šãƒ»ä¸€èˆ¬æƒ…å ± |
| project | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç† |
| issue | èª²é¡Œè¿½è·¡ãƒ»ã‚³ãƒ¡ãƒ³ãƒˆ |
| wiki | Wikiãƒšãƒ¼ã‚¸ç®¡ç† |
| git | Gitãƒªãƒã‚¸ãƒˆãƒªãƒ»ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆ |
| notifications | ãƒ¦ãƒ¼ã‚¶ãƒ¼é€šçŸ¥ |
| document | ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç®¡ç† |

AGENT-Oneã§ä½¿ç”¨ã™ã‚‹ãƒ„ãƒ¼ãƒ«ã‚»ãƒƒãƒˆ: `project,issue,git`

```bash
# å¿…è¦ãªãƒ„ãƒ¼ãƒ«ã‚»ãƒƒãƒˆã®ã¿æœ‰åŠ¹åŒ–
ENABLE_TOOLSETS="project,issue,git"
```

---

## ä»˜éŒ²C: Clerkè¨­å®šæ‰‹é †

### C.1 Clerkã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ

```
1. https://clerk.com ã«ã‚¢ã‚¯ã‚»ã‚¹
2. ã€ŒStart building for freeã€ã‚’ã‚¯ãƒªãƒƒã‚¯
3. GitHubã¾ãŸã¯Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—
4. æ–°è¦ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆ
   - Application name: AGENT-One
   - Sign in options: Email, Google, GitHub ã‚’é¸æŠ
```

### C.2 ç’°å¢ƒå¤‰æ•°ã®å–å¾—

Clerkãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‹ã‚‰ä»¥ä¸‹ã®å€¤ã‚’å–å¾—:

```bash
# .env.local
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_xxxxx
CLERK_SECRET_KEY=sk_test_xxxxx

# ã‚µã‚¤ãƒ³ã‚¤ãƒ³/ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—ãƒšãƒ¼ã‚¸ã®ãƒ‘ã‚¹
NEXT_PUBLIC_CLERK_SIGN_IN_URL=/sign-in
NEXT_PUBLIC_CLERK_SIGN_UP_URL=/sign-up
NEXT_PUBLIC_CLERK_AFTER_SIGN_IN_URL=/dashboard
NEXT_PUBLIC_CLERK_AFTER_SIGN_UP_URL=/dashboard
```

### C.3 Railwayç’°å¢ƒå¤‰æ•°è¨­å®š

Railway ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ä»¥ä¸‹ã‚’è¨­å®š:

| å¤‰æ•°å | å€¤ | èª¬æ˜ |
|--------|-----|------|
| `NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY` | `pk_live_xxxxx` | å…¬é–‹ã‚­ãƒ¼ï¼ˆæœ¬ç•ªç”¨ï¼‰ |
| `CLERK_SECRET_KEY` | `sk_live_xxxxx` | ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚­ãƒ¼ï¼ˆæœ¬ç•ªç”¨ï¼‰ |
| `NEXT_PUBLIC_CLERK_SIGN_IN_URL` | `/sign-in` | ã‚µã‚¤ãƒ³ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ãƒ‘ã‚¹ |
| `NEXT_PUBLIC_CLERK_SIGN_UP_URL` | `/sign-up` | ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—ãƒšãƒ¼ã‚¸ãƒ‘ã‚¹ |
| `NEXT_PUBLIC_CLERK_AFTER_SIGN_IN_URL` | `/dashboard` | ã‚µã‚¤ãƒ³ã‚¤ãƒ³å¾Œãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå…ˆ |
| `NEXT_PUBLIC_CLERK_AFTER_SIGN_UP_URL` | `/dashboard` | ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—å¾Œãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå…ˆ |

### C.4 OAuthãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼è¨­å®š

#### Google OAuthè¨­å®š

```
1. Google Cloud Console (https://console.cloud.google.com) ã«ã‚¢ã‚¯ã‚»ã‚¹
2. æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã¾ãŸã¯AGENT-Oneç”¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é¸æŠ
3. ã€ŒAPIã¨ã‚µãƒ¼ãƒ“ã‚¹ã€â†’ã€Œèªè¨¼æƒ…å ±ã€
4. ã€Œèªè¨¼æƒ…å ±ã‚’ä½œæˆã€â†’ã€ŒOAuth ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ IDã€
5. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ç¨®é¡: ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
6. æ‰¿èªæ¸ˆã¿ã®ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ URI:
   - é–‹ç™º: https://your-clerk-domain.clerk.accounts.dev/v1/oauth_callback
   - æœ¬ç•ª: Clerkãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«è¡¨ç¤ºã•ã‚Œã‚‹ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯URL
7. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆIDã¨ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚’Clerkãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ç™»éŒ²
```

#### GitHub OAuthè¨­å®š

```
1. GitHub Settings â†’ Developer settings â†’ OAuth Apps
2. ã€ŒNew OAuth Appã€ã‚’ã‚¯ãƒªãƒƒã‚¯
3. è¨­å®š:
   - Application name: AGENT-One
   - Homepage URL: https://your-app.up.railway.app
   - Authorization callback URL: Clerkãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯URL
4. Client IDã¨Client Secretã‚’Clerkãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ç™»éŒ²
```

### C.5 ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
npm install @clerk/nextjs
```

### C.6 å¿…é ˆãƒ•ã‚¡ã‚¤ãƒ«

**middleware.ts** (ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆ):
```typescript
import { clerkMiddleware, createRouteMatcher } from '@clerk/nextjs/server'

const isProtectedRoute = createRouteMatcher([
  '/dashboard(.*)',
  '/api/chat(.*)',
  '/api/projects(.*)',
  '/api/sessions(.*)',
  '/api/repo(.*)',
])

export default clerkMiddleware(async (auth, req) => {
  if (isProtectedRoute(req)) {
    await auth.protect()
  }
})

export const config = {
  matcher: [
    '/((?!_next|[^?]*\\.(?:html?|css|js(?!on)|jpe?g|webp|png|gif|svg|ttf|woff2?|ico|csv|docx?|xlsx?|zip|webmanifest)).*)',
    '/(api|trpc)(.*)',
  ],
}
```

**app/sign-in/[[...sign-in]]/page.tsx**:
```typescript
import { SignIn } from '@clerk/nextjs'

export default function SignInPage() {
  return (
    <div className="flex min-h-screen items-center justify-center">
      <SignIn />
    </div>
  )
}
```

**app/sign-up/[[...sign-up]]/page.tsx**:
```typescript
import { SignUp } from '@clerk/nextjs'

export default function SignUpPage() {
  return (
    <div className="flex min-h-screen items-center justify-center">
      <SignUp />
    </div>
  )
}
```

### C.7 Clerkç„¡æ–™æ 

| é …ç›® | åˆ¶é™ |
|------|------|
| Monthly Active Users (MAU) | 10,000 |
| OAuth/Social connections | ç„¡åˆ¶é™ |
| ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³ | 1 |
| ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç† | å«ã‚€ |
| MFA | å«ã‚€ |
| ãƒœãƒƒãƒˆæ¤œå‡º | å«ã‚€ |

### C.8 Clerk Webhookè¨­å®š

```
1. Clerkãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ â†’ Webhooks
2. ã€Œ+ Add Endpointã€
3. Endpoint URL: https://your-app.up.railway.app/api/webhooks/clerk
4. Events:
   - user.created
   - user.updated
   - user.deleted
5. ã€ŒCreateã€ã‚’ã‚¯ãƒªãƒƒã‚¯
6. Signing Secretã‚’ã‚³ãƒ”ãƒ¼ â†’ Railwayç’°å¢ƒå¤‰æ•°ã«è¨­å®š
```

**ç’°å¢ƒå¤‰æ•°è¿½åŠ **:
```bash
CLERK_WEBHOOK_SECRET=whsec_xxxxx
```

### C.9 ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

| å•é¡Œ | åŸå›  | å¯¾å‡¦æ³• |
|------|------|--------|
| ã‚µã‚¤ãƒ³ã‚¤ãƒ³å¾Œã« `/` ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã‚‹ | `AFTER_SIGN_IN_URL` æœªè¨­å®š | ç’°å¢ƒå¤‰æ•°ã‚’ç¢ºèª |
| ã€ŒUnauthorizedã€ã‚¨ãƒ©ãƒ¼ | middlewareè¨­å®šæ¼ã‚Œ | `middleware.ts` ã‚’ç¢ºèª |
| OAuthã‚¨ãƒ©ãƒ¼ | ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯URLä¸ä¸€è‡´ | ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼è¨­å®šã‚’ç¢ºèª |
| æœ¬ç•ªç’°å¢ƒã§èªè¨¼å¤±æ•— | ã‚­ãƒ¼ãŒé–‹ç™ºç”¨ | `pk_live_` / `sk_live_` ã«å¤‰æ›´ |
| Webhookç½²åæ¤œè¨¼å¤±æ•— | ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆä¸ä¸€è‡´ | CLERK_WEBHOOK_SECRETã‚’ç¢ºèª |

---

## ä»˜éŒ²D: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­å®šæ‰‹é †

### D.1 Railway PostgreSQLä½œæˆ

```
1. Railwayãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ã‚¢ã‚¯ã‚»ã‚¹
2. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é¸æŠ
3. ã€Œ+ Newã€â†’ã€ŒDatabaseã€â†’ã€ŒPostgreSQLã€
4. PostgreSQLã‚µãƒ¼ãƒ“ã‚¹ãŒè¿½åŠ ã•ã‚Œã‚‹
5. ã€ŒVariablesã€ã‚¿ãƒ–ã§æ¥ç¶šæƒ…å ±ã‚’ç¢ºèª
```

### D.2 ç’°å¢ƒå¤‰æ•°è¨­å®š

```bash
# .env.localï¼ˆãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç”¨ï¼‰
DATABASE_URL="postgresql://user:password@localhost:5432/agent_one?schema=public"

# æš—å·åŒ–ã‚­ãƒ¼ï¼ˆ32ãƒã‚¤ãƒˆã®16é€²æ•°æ–‡å­—åˆ— = 64æ–‡å­—ï¼‰
# ç”Ÿæˆã‚³ãƒãƒ³ãƒ‰: openssl rand -hex 32
ENCRYPTION_KEY="your-64-character-hex-string-here"

# Railwayå´ï¼ˆæœ¬ç•ªç”¨ï¼‰
# DATABASE_URLã¯è‡ªå‹•è¨­å®šã•ã‚Œã‚‹
# ENCRYPTION_KEYã¯æ‰‹å‹•è¨­å®šãŒå¿…è¦
```

### D.3 PrismaåˆæœŸè¨­å®š

```bash
# ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install prisma @prisma/client

# PrismaåˆæœŸåŒ–
npx prisma init

# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ä½œæˆãƒ»é©ç”¨ï¼ˆé–‹ç™ºç’°å¢ƒï¼‰
npx prisma migrate dev --name init

# æœ¬ç•ªç’°å¢ƒã¸ã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é©ç”¨
npx prisma migrate deploy

# Prisma Clientã®ç”Ÿæˆ
npx prisma generate
```

### D.4 Prismaã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè¨­å®š

```typescript
// src/lib/db.ts
import { PrismaClient } from '@prisma/client'

const globalForPrisma = globalThis as unknown as {
  prisma: PrismaClient | undefined
}

export const prisma = globalForPrisma.prisma ?? new PrismaClient({
  log: process.env.NODE_ENV === 'development' ? ['query', 'error', 'warn'] : ['error'],
})

if (process.env.NODE_ENV !== 'production') {
  globalForPrisma.prisma = prisma
}
```

### D.5 Railwayæœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤è¨­å®š

**package.json**:
```json
{
  "scripts": {
    "build": "prisma generate && prisma migrate deploy && next build",
    "start": "next start",
    "postinstall": "prisma generate"
  }
}
```

**railway.toml**:
```toml
[build]
builder = "nixpacks"

[deploy]
startCommand = "npm run start"
healthcheckPath = "/"
healthcheckTimeout = 300
```

### D.6 ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

| å•é¡Œ | åŸå›  | å¯¾å‡¦æ³• |
|------|------|--------|
| `P1001: Can't reach database` | DBæ¥ç¶šä¸å¯ | DATABASE_URLã‚’ç¢ºèª |
| `P2002: Unique constraint failed` | é‡è¤‡ãƒ‡ãƒ¼ã‚¿ | æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèª |
| ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å¤±æ•— | ã‚¹ã‚­ãƒ¼ãƒä¸æ•´åˆ | `prisma migrate reset` ã§åˆæœŸåŒ– |
| æš—å·åŒ–ã‚¨ãƒ©ãƒ¼ | ã‚­ãƒ¼é•·ä¸æ­£ | ENCRYPTION_KEYã¯64æ–‡å­—ï¼ˆ32ãƒã‚¤ãƒˆï¼‰å¿…è¦ |

---

## ä»˜éŒ²E: v1.2ã‹ã‚‰ã®ä¸»ãªå¤‰æ›´ç‚¹

### è¿½åŠ ã•ã‚ŒãŸæ©Ÿèƒ½

1. **ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼æ©Ÿèƒ½ï¼ˆClerkï¼‰**
   - ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—/ã‚µã‚¤ãƒ³ã‚¤ãƒ³/ã‚µã‚¤ãƒ³ã‚¢ã‚¦ãƒˆ
   - Google OAuth / GitHub OAuth
   - ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
   - ãƒ«ãƒ¼ãƒˆä¿è­·ï¼ˆmiddlewareï¼‰
   - Clerk Webhooké€£æº

2. **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆPostgreSQL + Prismaï¼‰**
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–
   - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–
   - ãƒãƒ£ãƒƒãƒˆå±¥æ­´æ°¸ç¶šåŒ–
   - æ©Ÿå¯†æƒ…å ±ã®æš—å·åŒ–ä¿å­˜

3. **ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å‡ºåŠ›**
   - Server-Sent Events (SSE) ã«ã‚ˆã‚‹ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¡¨ç¤º
   - é€æ¬¡çš„ãªãƒ†ã‚­ã‚¹ãƒˆæ›´æ–°
   - å®Œäº†/ã‚¨ãƒ©ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆé€šçŸ¥

4. **Markdownãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°**
   - react-markdown + remark-gfm ã«ã‚ˆã‚‹å¤‰æ›
   - ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ãƒã‚¤ãƒ©ã‚¤ãƒˆï¼ˆreact-syntax-highlighterï¼‰
   - GFMï¼ˆGitHub Flavored Markdownï¼‰å¯¾å¿œ
   - ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã€ãƒ†ãƒ¼ãƒ–ãƒ«ã€ãƒªã‚¹ãƒˆç­‰ã®æ•´å½¢è¡¨ç¤º

5. **ç”»é¢è¿½åŠ **
   - ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒšãƒ¼ã‚¸ï¼ˆæœªèªè¨¼ï¼‰
   - ã‚µã‚¤ãƒ³ã‚¤ãƒ³ãƒšãƒ¼ã‚¸
   - ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—ãƒšãƒ¼ã‚¸
   - ãƒãƒ£ãƒƒãƒˆå±¥æ­´ä¸€è¦§

6. **æ–°è¦APIè¿½åŠ **
   - `/api/projects` - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆCRUD
   - `/api/sessions` - ãƒãƒ£ãƒƒãƒˆã‚»ãƒƒã‚·ãƒ§ãƒ³CRUD
   - `/api/webhooks/clerk` - Clerk Webhook

### æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ã®è¿½åŠ 

| é …ç›® | v1.2 | v1.3 |
|------|------|------|
| èªè¨¼ | ãªã—ï¼ˆå°†æ¥å¯¾å¿œï¼‰ | âœ… Clerk |
| ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ | localStorage | âœ… PostgreSQL |
| ORM | ãªã— | âœ… Prisma |
| Markdownãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚° | ãªã— | âœ… react-markdown |
| ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ãƒã‚¤ãƒ©ã‚¤ãƒˆ | ãªã— | âœ… react-syntax-highlighter |
| ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚° | ãªã— | âœ… Server-Sent Events |

### å‰Šé™¤ã•ã‚ŒãŸé …ç›®

- localStorage ã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿ä¿å­˜ï¼ˆDBã«ç§»è¡Œï¼‰

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã®è¿½åŠ 

```
è¿½åŠ :
â”œâ”€â”€ prisma/
â”‚   â”œâ”€â”€ schema.prisma
â”‚   â””â”€â”€ migrations/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ middleware.ts
â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â””â”€â”€ useChat.ts
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ db.ts
â”‚   â”‚   â””â”€â”€ crypto.ts
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ sign-in/
â”‚   â”‚   â”œâ”€â”€ sign-up/
â”‚   â”‚   â”œâ”€â”€ dashboard/
â”‚   â”‚   â””â”€â”€ api/
â”‚   â”‚       â”œâ”€â”€ projects/
â”‚   â”‚       â”œâ”€â”€ sessions/
â”‚   â”‚       â””â”€â”€ webhooks/clerk/
â”‚   â””â”€â”€ components/
â”‚       â”œâ”€â”€ MarkdownRenderer.tsx
â”‚       â””â”€â”€ SessionList.tsx
```

### éæ©Ÿèƒ½è¦ä»¶ã®å¤‰æ›´

| é …ç›® | v1.2 | v1.3 |
|------|------|------|
| ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ | ãªã— | âœ… Clerkï¼ˆSOC 2æº–æ‹ ï¼‰ |
| åŒæ™‚æ¥ç¶š | å˜ä¸€ãƒ¦ãƒ¼ã‚¶ãƒ¼ | è¤‡æ•°ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆ10,000 MAUï¼‰ |
| ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ– | localStorage | âœ… PostgreSQL |
| APIã‚­ãƒ¼ç®¡ç† | localStorage | âœ… DBæš—å·åŒ–ä¿å­˜ |
| ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ— | ãªã— | âœ… Railwayè‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ— |
